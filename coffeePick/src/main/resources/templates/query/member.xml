<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="templates.query.member">


<!-- 지훈  -->
<insert id="memberJoin" parameterType="member">
    <!-- 회원가입 처리 쿼리 -->
    INSERT INTO member(MEMBER_NO, MEMBER_ID, MEMBER_PW, MEMBER_NAME, MEMBER_NICKNAME,
    MEMBER_EMAIL, MEMBER_ADDR, MEMBER_PHONE, MEMBER_REGDATE, MEMBER_STATUS)
    VALUES(member_seq.NEXTVAL, #{member_id}, #{member_pw}, #{member_name}, #{member_nickname},
    #{member_email}, #{member_addr}, #{member_phone}, SYSDATE, 'Y')
</insert>
<select id="nick_check" parameterType="String" resultType="int">
    <!-- 닉네임 중복 체크 쿼리 -->
    SELECT COUNT(*) FROM member WHERE MEMBER_NICKNAME = #{member_nickname}
</select>

<select id="id_check" parameterType="String" resultType="int">
    <!-- 아이디 중복 체크 쿼리 -->
    SELECT COUNT(*) FROM member WHERE MEMBER_ID = #{member_id}
</select>

 <select id="login" parameterType="member" resultType="member">
    <!-- 로그인 처리 쿼리, 아이디 비밀번호가 맞으면 해당 id가 가진 컬럼값들을 리턴 -->
    SELECT MEMBER_ID,MEMBER_NAME,MEMBER_NICKNAME,MEMBER_EMAIL,MEMBER_ADDR,MEMBER_PHONE,
     MEMBER_REGDATE FROM member 
    WHERE MEMBER_ID = #{id} AND MEMBER_PW = #{pw} AND MEMBER_STATUS='Y'    
</select>

<select id="memberIdFind" parameterType="String" resultType="String">
<!-- 핸드폰번호로 회원 아이디 찾기  -->
SELECT MEMBER_ID FROM member
where member_phone=#{phoneNumber}
</select>

<select id="memberIdFind_email" parameterType="String" resultType="String">
<!-- 이메일로 회원 아이디 찾기  -->
SELECT MEMBER_ID FROM member
where member_email=#{member_email}
</select>

 <select id="memberPwFind_phone" parameterType="member" resultType="member">
    <!-- 핸드폰번호로 회원 비밀번호 찾기  -->
    SELECT MEMBER_ID,MEMBER_NAME,MEMBER_PHONE
    FROM member 
    WHERE MEMBER_ID = #{member_id} AND MEMBER_NAME = #{member_name} AND MEMBER_PHONE=#{member_phone}    
</select>

	
 <select id="memberPwFind_email" parameterType="member" resultType="member">
    <!-- 이메일로 회원 비밀번호 찾기  -->
    SELECT MEMBER_ID,MEMBER_NAME,MEMBER_EMAIL
    FROM member 
    WHERE MEMBER_ID = #{member_id} AND MEMBER_NAME = #{member_name} AND MEMBER_EMAIL=#{member_email}    
</select>


<update id="pwAlter" parameterType="String">
<!-- 비밀번호 변경 -->
		UPDATE member
		SET member_pw=#{member_pw}
		WHERE member_id=#{member_id}		
	</update>
	
	
<select id="member_pw_check" parameterType="String">
<!--회원삭제전 비밀번호 확인  -->
		SELECT member_id,member_pw
		FROM member
		where member_id=#{member_id} AND member_pw=#{member_pw}

</select>
<update id="member_delete" parameterType="String">
<!--회원 삭제  -->
	UPDATE member
	SET MEMBER_STATUS='N'
	where member_id=#{member_id} AND member_pw=#{member_pw}
</update>

<update id="member_data_update" parameterType="String">
<!--회원 정보 수정  -->
UPDATE member
SET member_name=#{member_name},
member_nickname=#{member_nickname},
member_email=#{member_email},
member_addr=#{member_addr},
member_phone=#{member_phone}
where member_id=#{member_id}
</update>	

<select id="email_check" parameterType="String" resultType="int">
    <!-- 이메일 중복 체크 쿼리 -->
    SELECT COUNT(*) FROM member WHERE MEMBER_email = #{member_email}
</select>	
	
<select id="phone_check" parameterType="String" resultType="int">
    <!-- 핸드폰 중복 체크 쿼리 -->
    SELECT COUNT(*) FROM member WHERE member_phone = #{member_phone}
</select>		
	
	<!-- 회원가입 할떄 이것 세개 삽입 -->
<!-- 	   <insert id="pointInsert" parameterType="point">
      INSERT INTO point(member_id,point_total)
      VALUES(#{member_id},DEFAULT);
   </insert>
   <insert id="pickmoneyInsert" parameterType="pickmoney">
      INSERT INTO pickmoney(member_id,pickmoney_total)
      VALUES(#{member_id},DEFAULT);
   </insert>
   <insert id="cartInsert" parameterType="cart">
      INSERT INTO cart(cart_id,member_id)
      VALUES(#{cart_id},#{member_id});
   </insert>  -->
   
</mapper>